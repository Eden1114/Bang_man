{"version":3,"sources":["..\\..\\..\\..\\assets\\script/assets\\script\\drop-control.js"],"names":["cc","Class","extends","Component","properties","boomPrefabArray","Prefab","groundPanel","Node","_gridControl","_boomMap","onLoad","systemEvent","on","onKeyDown","require","e","keyCode","KEY","space","dropBoom","grid","getGrid","node","position","isBoomSet","setBoom","boomIdx","Math","floor","random","length","boom","instantiate","addChild","getGridPosition","getComponent","init","zIndex"],"mappings":";;;;;;AAAAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACR;AACAC,yBAAiB,CAACL,GAAGM,MAAJ,CAFT;AAGRC,qBAAaP,GAAGQ,IAHR;AAIRC,sBAAc,IAJN;AAKRC,kBAAU;AALF,KAHP;;AAWLC,YAAQ,kBAAY;AAChBX,WAAGY,WAAH,CAAeC,EAAf,CAAkB,SAAlB,EAA4B,KAAKC,SAAjC,EAA2C,IAA3C,GACA,KAAKL,YAAL,GAAoBM,QAAQ,cAAR,CADpB;AAEA,aAAKL,QAAL,GAAgBK,QAAQ,UAAR,CAAhB;AAEH,KAhBI;;AAkBLD,eAAW,mBAASE,CAAT,EAAW;AAClB,YAAGA,EAAEC,OAAF,IAAajB,GAAGkB,GAAH,CAAOC,KAAvB,EAA6B;AACrB,iBAAKC,QAAL;AACP;AACJ,KAtBI;AAuBL;AACAA,cAAU,oBAAU;AAChB,YAAIC,OAAO,KAAKZ,YAAL,CAAkBa,OAAlB,CAA0B,KAAKC,IAAL,CAAUC,QAApC,CAAX;AACA,YAAG,KAAKd,QAAL,CAAce,SAAd,CAAwBJ,IAAxB,CAAH,EAAiC;AAAC;AAAQ;AAC1C,aAAKX,QAAL,CAAcgB,OAAd,CAAsBL,IAAtB;AACA,YAAIM,UAAUC,KAAKC,KAAL,CAAWD,KAAKE,MAAL,KAAgB,KAAKzB,eAAL,CAAqB0B,MAAhD,CAAd;AACA,YAAIC,OAAOhC,GAAGiC,WAAH,CAAe,KAAK5B,eAAL,CAAqBsB,OAArB,CAAf,CAAX;AACA,aAAKpB,WAAL,CAAiB2B,QAAjB,CAA0BF,IAA1B;AACA;AACA;AACAA,aAAKR,QAAL,GAAgB,KAAKf,YAAL,CAAkB0B,eAAlB,CAAkC,KAAKZ,IAAL,CAAUC,QAA5C,CAAhB;AACAQ,aAAKI,YAAL,CAAkB,cAAlB,EAAkCC,IAAlC;AACAL,aAAKM,MAAL,GAAc,KAAKf,IAAL,CAAUe,MAAV,GAAmB,CAAjC;AACH;;AApCI,CAAT","file":"drop-control.js","sourceRoot":"..\\..\\..\\..\\assets\\script","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        //boomPrefab: cc.Prefab,\r\n        boomPrefabArray: [cc.Prefab],\r\n        groundPanel: cc.Node,\r\n        _gridControl: null,\r\n        _boomMap: null,\r\n    },\r\n\r\n    onLoad: function () {\r\n        cc.systemEvent.on('keydown',this.onKeyDown,this),\r\n        this._gridControl = require('grid-control');\r\n        this._boomMap = require('boom-map');\r\n\r\n    },\r\n\r\n    onKeyDown: function(e){\r\n        if(e.keyCode == cc.KEY.space){\r\n                this.dropBoom();\r\n        }\r\n    },\r\n    //[fix] design the way the cal the grid position and drop the boom in the center of grid\r\n    dropBoom: function(){\r\n        let grid = this._gridControl.getGrid(this.node.position);\r\n        if(this._boomMap.isBoomSet(grid)){return;}\r\n        this._boomMap.setBoom(grid);\r\n        let boomIdx = Math.floor(Math.random() * this.boomPrefabArray.length);\r\n        let boom = cc.instantiate(this.boomPrefabArray[boomIdx]);\r\n        this.groundPanel.addChild(boom);\r\n        //[add] set grid position of boom\r\n        //boom.position = this.node.position;\r\n        boom.position = this._gridControl.getGridPosition(this.node.position);\r\n        boom.getComponent('boom-control').init();\r\n        boom.zIndex = this.node.zIndex - 1;\r\n    },\r\n\r\n});\r\n"]}