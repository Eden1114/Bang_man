{"version":3,"sources":["../../../../assets/script/assets/script/enemy-generator.js"],"names":["cc","Class","extends","Component","properties","enemyPrefabArray","Prefab","time","num","_currentTime","ground","Node","_sceneLoading","onLoad","window","enemyNum","schedule","generator","bind","director","loadScene","i","enemyIdx","Math","floor","random","length","enemy","instantiate","randomPosition","v2","round","random0To1","addChild","name","Date","now","position"],"mappings":";;;;;;AAAA;AACAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,0BAAkB,CAACL,GAAGM,MAAJ,CADV;AAERC,cAAM,EAFE;AAGRC,aAAK,CAHG;AAIRC,sBAAc,CAJN;AAKRC,gBAAQV,GAAGW,IALH;AAMRC,uBAAe;AANP,KAHP;;AAYLC,YAAQ,kBAAY;AAChBC,eAAOC,QAAP,GAAkB,CAAlB;AACA,aAAKC,QAAL,CAAc,KAAKC,SAAL,CAAeC,IAAf,CAAoB,IAApB,CAAd,EAAyC,CAAzC;AACH,KAfI;;AAiBLD,eAAW,qBAAY;AACnB,YAAIH,OAAOC,QAAP,IAAmB,CAAvB,EAA0B;;AAEtB;AACA,gBAAI,KAAKN,YAAL,IAAqB,KAAKF,IAA9B,EAAoC;AAChC,oBAAI,CAAC,KAAKK,aAAV,EAAyB;AACrB,yBAAKA,aAAL,GAAqB,IAArB;AACAZ,uBAAGmB,QAAH,CAAYC,SAAZ,CAAsB,WAAtB;AACA;AACH;AACJ;;AAED;AARA,iBASK;AACD,wBAAIL,WAAW,KAAKP,GAAL,GAAW,KAAKC,YAAhB,GAA+B,CAA9C;;AAEA,yBAAK,IAAIY,IAAI,CAAb,EAAgBA,IAAIN,QAApB,EAA8BM,GAA9B,EAAmC;AAC/B,4BAAIC,WAAWC,KAAKC,KAAL,CAAWD,KAAKE,MAAL,KAAgB,KAAKpB,gBAAL,CAAsBqB,MAAjD,CAAf;AACA,4BAAIC,QAAQ3B,GAAG4B,WAAH,CAAe,KAAKvB,gBAAL,CAAsBiB,QAAtB,CAAf,CAAZ;AACA,4BAAIO,iBAAiB,IAArB;;AAEA;AACA,4BAAIN,KAAKE,MAAL,KAAgB,GAApB,EAAyB;AACrBI,6CAAiB7B,GAAG8B,EAAH,CAAMP,KAAKQ,KAAL,CAAW/B,GAAGgC,UAAH,KAAkB,GAA7B,CAAN,EAAyChC,GAAGgC,UAAH,KAAkB,GAA3D,CAAjB;AACH,yBAFD,MAEO;AACHH,6CAAiB7B,GAAG8B,EAAH,CAAM9B,GAAGgC,UAAH,KAAkB,GAAxB,EAA6BT,KAAKQ,KAAL,CAAW/B,GAAGgC,UAAH,EAAX,IAA8B,GAA3D,CAAjB;AACH;;AAED,6BAAKtB,MAAL,CAAYuB,QAAZ,CAAqBN,KAArB;AACAA,8BAAMO,IAAN,GAAa,UAAUC,KAAKC,GAAL,EAAvB;AACAT,8BAAMU,QAAN,GAAiBR,cAAjB;AACAf,+BAAOC,QAAP;AACH;;AAED,yBAAKN,YAAL;AACH;AACJ;AACJ;AAtDI,CAAT","file":"enemy-generator.js","sourceRoot":"../../../../assets/script","sourcesContent":["/**生成敌人的脚本 */\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        enemyPrefabArray: [cc.Prefab],\n        time: 10,\n        num: 1,\n        _currentTime: 1,\n        ground: cc.Node,\n        _sceneLoading: false,\n    },\n\n    onLoad: function () {\n        window.enemyNum = 0;\n        this.schedule(this.generator.bind(this), 1);\n    },\n\n    generator: function () {\n        if (window.enemyNum == 0) {\n\n            //结束所有轮游戏，进入胜利界面\n            if (this._currentTime == this.time) {\n                if (!this._sceneLoading) {\n                    this._sceneLoading = true;\n                    cc.director.loadScene('win-scene');\n                    return;\n                }\n            }\n\n            //进入下一轮，添加敌人\n            else {\n                let enemyNum = this.num * this._currentTime + 3;\n\n                for (let i = 0; i < enemyNum; i++) {\n                    let enemyIdx = Math.floor(Math.random() * this.enemyPrefabArray.length);\n                    let enemy = cc.instantiate(this.enemyPrefabArray[enemyIdx]);\n                    let randomPosition = null;\n\n                    //enemy的生成位置\n                    if (Math.random() > 0.5) {\n                        randomPosition = cc.v2(Math.round(cc.random0To1() * 950), cc.random0To1() * 530);\n                    } else {\n                        randomPosition = cc.v2(cc.random0To1() * 950, Math.round(cc.random0To1()) * 530);\n                    }\n\n                    this.ground.addChild(enemy);\n                    enemy.name = 'enemy' + Date.now();\n                    enemy.position = randomPosition;\n                    window.enemyNum++;\n                }\n\n                this._currentTime++;\n            }\n        }\n    }\n});\n"]}