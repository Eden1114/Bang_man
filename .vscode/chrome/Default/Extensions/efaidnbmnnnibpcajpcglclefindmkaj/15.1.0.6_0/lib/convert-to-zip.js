function dependOn(){"use strict";return[require("util"),require("common"),require("analytics"),require("proxy"),require("communicate")]}var def;require=function(a){"use strict";return a},def=window.define?window.define:function(a,b){"use strict";return b.apply(null,[{ajax:$.ajax.bind($)}])};var exports=acom_analytics={};def(dependOn(),function(a,b,c,d,e){"use strict";var g,h,i,j,f=null;i=function(){return e.getModule("upload")},j=function(){return e.getModule("download-manager")},g=function(){var b,c,e;this.proxy=d.proxy.bind(this),zip.workerScriptsPath="/lib/libs/",this.compress=function(f,g){var h=new zip.BlobWriter;b=JSON.parse(f),zip.createWriter(h,function(f){function l(){c.close(function(b){a.consoleLog("closing writer"),i().uploadHTML(b,g).done(d.proxy(j().uploadHandler)),saveAs(b,"test.zip"),c=null})}function m(d){if(k=b.refs[d])if(k.data){var f,g;e=new zip.TextReader(k.data),"html"===k.type?(f="text/html",g=k.placeholder):"css"===k.type?(g="refs/"+k.placeholder.replace(/refs\//,""),f="text/css"):"image"===k.type?(g="refs/"+k.placeholder.replace(/refs\//,""),f="image/jpeg",e=new zip.Data64URIReader(k.data)):(f="text/plain",g="refs/"+k.placeholder.replace(/refs\//,"")),c.add(g,e,function(){a.consoleLog("Added ref file"),d+=1,d<b.refs.length?m(d):l()})}else a.consoleLog("empty data"),a.consoleLogDir(k),d===b.refs.length?l():(d+=1,m(d));else l()}var k,h=0;c=f,c.add("index.html",new zip.TextReader(b.html),function(){a.consoleLog("Added main html file"),m(h)})},function(){a.consoleLog("Error occured while creating zip writer.")})}},f||(f=new g,e.registerModule("convert-to-zip",f));for(h in f)f.hasOwnProperty(h)&&("function"==typeof f[h]?exports[h]=f[h].bind(f):exports[h]=f[h]);return f});