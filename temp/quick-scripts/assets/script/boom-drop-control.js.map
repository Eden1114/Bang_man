{"version":3,"sources":["boom-drop-control.js"],"names":["cc","Class","extends","Component","properties","boomPrefabArray","Prefab","groundPanel","Node","_gridControl","_boomMap","onLoad","systemEvent","on","onKeyDown","require","e","keyCode","KEY","space","dropBoom","grid","getGrid","node","position","isBoomSet","setBoom","boomIdx","Math","floor","random","length","boom","instantiate","addChild","getGridPosition","getComponent","init","zIndex"],"mappings":";;;;;;AAAAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACR;AACAC,yBAAiB,CAACL,GAAGM,MAAJ,CAFT;AAGRC,qBAAaP,GAAGQ,IAHR;AAIRC,sBAAc,IAJN;AAKRC,kBAAU;AALF,KAHP;;AAWLC,YAAQ,kBAAY;AAChBX,WAAGY,WAAH,CAAeC,EAAf,CAAkB,SAAlB,EAA4B,KAAKC,SAAjC,EAA2C,IAA3C,GACA,KAAKL,YAAL,GAAoBM,QAAQ,cAAR,CADpB;AAEA,aAAKL,QAAL,GAAgBK,QAAQ,UAAR,CAAhB;AACH,KAfI;;AAiBLD,eAAW,mBAASE,CAAT,EAAW;AAClB,YAAGA,EAAEC,OAAF,IAAajB,GAAGkB,GAAH,CAAOC,KAAvB,EAA6B;AACzB,iBAAKC,QAAL;AACH;AACJ,KArBI;AAsBL;AACAA,cAAU,oBAAU;AAChB,YAAIC,OAAO,KAAKZ,YAAL,CAAkBa,OAAlB,CAA0B,KAAKC,IAAL,CAAUC,QAApC,CAAX;AACA,YAAG,KAAKd,QAAL,CAAce,SAAd,CAAwBJ,IAAxB,CAAH,EAAiC;AAAC;AAAQ;AAC1C,aAAKX,QAAL,CAAcgB,OAAd,CAAsBL,IAAtB;AACA,YAAIM,UAAUC,KAAKC,KAAL,CAAWD,KAAKE,MAAL,KAAgB,KAAKzB,eAAL,CAAqB0B,MAAhD,CAAd;AACA,YAAIC,OAAOhC,GAAGiC,WAAH,CAAe,KAAK5B,eAAL,CAAqBsB,OAArB,CAAf,CAAX;AACA,aAAKpB,WAAL,CAAiB2B,QAAjB,CAA0BF,IAA1B;AACA;AACA;AACAA,aAAKR,QAAL,GAAgB,KAAKf,YAAL,CAAkB0B,eAAlB,CAAkC,KAAKZ,IAAL,CAAUC,QAA5C,CAAhB;AACAQ,aAAKI,YAAL,CAAkB,cAAlB,EAAkCC,IAAlC;AACAL,aAAKM,MAAL,GAAc,KAAKf,IAAL,CAAUe,MAAV,GAAmB,CAAjC;AACH;;AAnCI,CAAT","file":"boom-drop-control.js","sourceRoot":"../../../../assets/script","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        //boomPrefab: cc.Prefab,\n        boomPrefabArray: [cc.Prefab],\n        groundPanel: cc.Node,\n        _gridControl: null,\n        _boomMap: null,\n    },\n\n    onLoad: function () {\n        cc.systemEvent.on('keydown',this.onKeyDown,this),\n        this._gridControl = require('grid-control');\n        this._boomMap = require('boom-map');\n    },\n\n    onKeyDown: function(e){\n        if(e.keyCode == cc.KEY.space){\n            this.dropBoom();\n        }\n    },\n    //[fix] design the way the cal the grid position and drop the boom in the center of grid\n    dropBoom: function(){\n        let grid = this._gridControl.getGrid(this.node.position);\n        if(this._boomMap.isBoomSet(grid)){return;}\n        this._boomMap.setBoom(grid);\n        let boomIdx = Math.floor(Math.random() * this.boomPrefabArray.length);\n        let boom = cc.instantiate(this.boomPrefabArray[boomIdx]);\n        this.groundPanel.addChild(boom);\n        //[add] set grid position of boom\n        //boom.position = this.node.position;\n        boom.position = this._gridControl.getGridPosition(this.node.position);\n        boom.getComponent('boom-control').init();\n        boom.zIndex = this.node.zIndex - 1;\n    },\n\n});\n"]}